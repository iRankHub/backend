// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.26.0
// source: user_profiles.sql

package models

import (
	"context"
	"database/sql"
)

const createUserProfile = `-- name: CreateUserProfile :one
INSERT INTO UserProfiles (UserID, Name, UserRole, Email, Password, VerificationStatus, Address, Phone, Bio, ProfilePicture, Gender)
VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)
RETURNING profileid, userid, name, userrole, email, password, gender, address, phone, bio, profilepicture, verificationstatus
`

type CreateUserProfileParams struct {
	Userid             int32          `json:"userid"`
	Name               string         `json:"name"`
	Userrole           string         `json:"userrole"`
	Email              string         `json:"email"`
	Password           string         `json:"password"`
	Verificationstatus sql.NullBool   `json:"verificationstatus"`
	Address            sql.NullString `json:"address"`
	Phone              sql.NullString `json:"phone"`
	Bio                sql.NullString `json:"bio"`
	Profilepicture     []byte         `json:"profilepicture"`
	Gender             sql.NullString `json:"gender"`
}

func (q *Queries) CreateUserProfile(ctx context.Context, arg CreateUserProfileParams) (Userprofile, error) {
	row := q.db.QueryRowContext(ctx, createUserProfile,
		arg.Userid,
		arg.Name,
		arg.Userrole,
		arg.Email,
		arg.Password,
		arg.Verificationstatus,
		arg.Address,
		arg.Phone,
		arg.Bio,
		arg.Profilepicture,
		arg.Gender,
	)
	var i Userprofile
	err := row.Scan(
		&i.Profileid,
		&i.Userid,
		&i.Name,
		&i.Userrole,
		&i.Email,
		&i.Password,
		&i.Gender,
		&i.Address,
		&i.Phone,
		&i.Bio,
		&i.Profilepicture,
		&i.Verificationstatus,
	)
	return i, err
}

const getUserProfile = `-- name: GetUserProfile :one
SELECT
    u.UserID, u.Name, u.Email, u.UserRole, u.password, u.Gender, u.VerificationStatus,
    u.two_factor_enabled, u.created_at AS SignUpDate,
    up.Address, up.Phone, up.Bio, up.ProfilePicture,
    s.Grade, s.DateOfBirth, s.SchoolID,
    sch.SchoolName, sch.Address AS SchoolAddress, sch.Country, sch.Province, sch.District, sch.SchoolType,
    v.Role AS VolunteerRole, v.GraduateYear, v.SafeGuardCertificate, v.HasInternship, v.IsEnrolledInUniversity,
    CASE WHEN EXISTS (
        SELECT 1 FROM WebAuthnCredentials wac WHERE wac.UserID = u.UserID
    ) THEN true ELSE false END AS biometric_auth_enabled
FROM Users u
LEFT JOIN UserProfiles up ON u.UserID = up.UserID
LEFT JOIN Students s ON u.UserID = s.UserID
LEFT JOIN Schools sch ON u.UserID = sch.ContactPersonID
LEFT JOIN Volunteers v ON u.UserID = v.UserID
WHERE u.UserID = $1 AND u.deleted_at IS NULL
`

type GetUserProfileRow struct {
	Userid                 int32          `json:"userid"`
	Name                   string         `json:"name"`
	Email                  string         `json:"email"`
	Userrole               string         `json:"userrole"`
	Password               string         `json:"password"`
	Gender                 sql.NullString `json:"gender"`
	Verificationstatus     sql.NullBool   `json:"verificationstatus"`
	TwoFactorEnabled       sql.NullBool   `json:"two_factor_enabled"`
	Signupdate             sql.NullTime   `json:"signupdate"`
	Address                sql.NullString `json:"address"`
	Phone                  sql.NullString `json:"phone"`
	Bio                    sql.NullString `json:"bio"`
	Profilepicture         []byte         `json:"profilepicture"`
	Grade                  sql.NullString `json:"grade"`
	Dateofbirth            sql.NullTime   `json:"dateofbirth"`
	Schoolid               sql.NullInt32  `json:"schoolid"`
	Schoolname             sql.NullString `json:"schoolname"`
	Schooladdress          sql.NullString `json:"schooladdress"`
	Country                sql.NullString `json:"country"`
	Province               sql.NullString `json:"province"`
	District               sql.NullString `json:"district"`
	Schooltype             sql.NullString `json:"schooltype"`
	Volunteerrole          sql.NullString `json:"volunteerrole"`
	Graduateyear           sql.NullInt32  `json:"graduateyear"`
	Safeguardcertificate   []byte         `json:"safeguardcertificate"`
	Hasinternship          sql.NullBool   `json:"hasinternship"`
	Isenrolledinuniversity sql.NullBool   `json:"isenrolledinuniversity"`
	BiometricAuthEnabled   bool           `json:"biometric_auth_enabled"`
}

func (q *Queries) GetUserProfile(ctx context.Context, userid int32) (GetUserProfileRow, error) {
	row := q.db.QueryRowContext(ctx, getUserProfile, userid)
	var i GetUserProfileRow
	err := row.Scan(
		&i.Userid,
		&i.Name,
		&i.Email,
		&i.Userrole,
		&i.Password,
		&i.Gender,
		&i.Verificationstatus,
		&i.TwoFactorEnabled,
		&i.Signupdate,
		&i.Address,
		&i.Phone,
		&i.Bio,
		&i.Profilepicture,
		&i.Grade,
		&i.Dateofbirth,
		&i.Schoolid,
		&i.Schoolname,
		&i.Schooladdress,
		&i.Country,
		&i.Province,
		&i.District,
		&i.Schooltype,
		&i.Volunteerrole,
		&i.Graduateyear,
		&i.Safeguardcertificate,
		&i.Hasinternship,
		&i.Isenrolledinuniversity,
		&i.BiometricAuthEnabled,
	)
	return i, err
}

const softDeleteUserProfile = `-- name: SoftDeleteUserProfile :exec
UPDATE Users
SET deleted_at = CURRENT_TIMESTAMP
WHERE UserID = $1
`

func (q *Queries) SoftDeleteUserProfile(ctx context.Context, userid int32) error {
	_, err := q.db.ExecContext(ctx, softDeleteUserProfile, userid)
	return err
}

const updateSchoolProfile = `-- name: UpdateSchoolProfile :exec
UPDATE Schools
SET
    SchoolName = COALESCE($2, SchoolName),
    Address = COALESCE($3, Address),
    Country = COALESCE($4, Country),
    Province = COALESCE($5, Province),
    District = COALESCE($6, District),
    SchoolType = COALESCE($7, SchoolType)
WHERE ContactPersonID = $1
`

type UpdateSchoolProfileParams struct {
	Contactpersonid int32          `json:"contactpersonid"`
	Schoolname      string         `json:"schoolname"`
	Address         string         `json:"address"`
	Country         sql.NullString `json:"country"`
	Province        sql.NullString `json:"province"`
	District        sql.NullString `json:"district"`
	Schooltype      string         `json:"schooltype"`
}

func (q *Queries) UpdateSchoolProfile(ctx context.Context, arg UpdateSchoolProfileParams) error {
	_, err := q.db.ExecContext(ctx, updateSchoolProfile,
		arg.Contactpersonid,
		arg.Schoolname,
		arg.Address,
		arg.Country,
		arg.Province,
		arg.District,
		arg.Schooltype,
	)
	return err
}

const updateStudentProfile = `-- name: UpdateStudentProfile :exec
UPDATE Students
SET
    Grade = COALESCE($2, Grade),
    DateOfBirth = COALESCE($3, DateOfBirth),
    SchoolID = COALESCE($4, SchoolID)
WHERE UserID = $1
`

type UpdateStudentProfileParams struct {
	Userid      int32        `json:"userid"`
	Grade       string       `json:"grade"`
	Dateofbirth sql.NullTime `json:"dateofbirth"`
	Schoolid    int32        `json:"schoolid"`
}

func (q *Queries) UpdateStudentProfile(ctx context.Context, arg UpdateStudentProfileParams) error {
	_, err := q.db.ExecContext(ctx, updateStudentProfile,
		arg.Userid,
		arg.Grade,
		arg.Dateofbirth,
		arg.Schoolid,
	)
	return err
}

const updateUserBasicInfo = `-- name: UpdateUserBasicInfo :exec
UPDATE Users
SET
    Name = COALESCE($2, Name),
    Email = COALESCE($3, Email),
    Gender = COALESCE($4, Gender),
    updated_at = CURRENT_TIMESTAMP
WHERE UserID = $1
`

type UpdateUserBasicInfoParams struct {
	Userid int32          `json:"userid"`
	Name   string         `json:"name"`
	Email  string         `json:"email"`
	Gender sql.NullString `json:"gender"`
}

func (q *Queries) UpdateUserBasicInfo(ctx context.Context, arg UpdateUserBasicInfoParams) error {
	_, err := q.db.ExecContext(ctx, updateUserBasicInfo,
		arg.Userid,
		arg.Name,
		arg.Email,
		arg.Gender,
	)
	return err
}

const updateUserProfile = `-- name: UpdateUserProfile :exec
UPDATE UserProfiles
SET
    Name = COALESCE($2, Name),
    Email = COALESCE($3, Email),
    Gender = COALESCE($4, Gender),
    Address = COALESCE($5, Address),
    Phone = COALESCE($6, Phone),
    Bio = COALESCE($7, Bio),
    ProfilePicture = COALESCE($8, ProfilePicture)
WHERE UserID = $1
`

type UpdateUserProfileParams struct {
	Userid         int32          `json:"userid"`
	Name           string         `json:"name"`
	Email          string         `json:"email"`
	Gender         sql.NullString `json:"gender"`
	Address        sql.NullString `json:"address"`
	Phone          sql.NullString `json:"phone"`
	Bio            sql.NullString `json:"bio"`
	Profilepicture []byte         `json:"profilepicture"`
}

func (q *Queries) UpdateUserProfile(ctx context.Context, arg UpdateUserProfileParams) error {
	_, err := q.db.ExecContext(ctx, updateUserProfile,
		arg.Userid,
		arg.Name,
		arg.Email,
		arg.Gender,
		arg.Address,
		arg.Phone,
		arg.Bio,
		arg.Profilepicture,
	)
	return err
}

const updateVolunteerProfile = `-- name: UpdateVolunteerProfile :exec
UPDATE Volunteers
SET
    Role = COALESCE($2, Role),
    GraduateYear = COALESCE($3, GraduateYear),
    SafeGuardCertificate = COALESCE($4, SafeGuardCertificate),
    HasInternship = COALESCE($5, HasInternship),
    IsEnrolledInUniversity = COALESCE($6, IsEnrolledInUniversity)
WHERE UserID = $1
`

type UpdateVolunteerProfileParams struct {
	Userid                 int32         `json:"userid"`
	Role                   string        `json:"role"`
	Graduateyear           sql.NullInt32 `json:"graduateyear"`
	Safeguardcertificate   []byte        `json:"safeguardcertificate"`
	Hasinternship          sql.NullBool  `json:"hasinternship"`
	Isenrolledinuniversity sql.NullBool  `json:"isenrolledinuniversity"`
}

func (q *Queries) UpdateVolunteerProfile(ctx context.Context, arg UpdateVolunteerProfileParams) error {
	_, err := q.db.ExecContext(ctx, updateVolunteerProfile,
		arg.Userid,
		arg.Role,
		arg.Graduateyear,
		arg.Safeguardcertificate,
		arg.Hasinternship,
		arg.Isenrolledinuniversity,
	)
	return err
}
